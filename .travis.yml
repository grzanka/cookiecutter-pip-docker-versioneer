language: python

# travis-ci runs by default on ancient Ubuntu 12.04 (precise), with support until XXX
# following options will give us Ubuntu 14.04 (trusty)
sudo: required
dist: trusty


# for testing we'll use tox
# test matrix will include three types of python interpreter:
#   - on travis level: "python: XX"
#   - inside template virtualenv generated by tox: "pyXX" in TOXENV
#   - testing template includes generating a project
#        this project will use virtualenv generated by ita own tox: "projXX" in TOXENV
# other elements like "docs" will be used to test correctness of template documentation
matrix:
    include:
        - os: linux
          python: 2.7
          env: TOXENV=py27-proj27
        - os: linux
          python: 3.3
          env: TOXENV=py33-proj33
        - os: linux
          python: 3.4
          env: TOXENV=py34-proj34
        - os: linux
          python: 3.5
          env: TOXENV=py35-proj35
        - os: linux
          python: 3.5-dev
          env: TOXENV=py35-proj35
        # travis nightly points to python 3.6 now
        - os: linux
          python: nightly
          env: TOXENV=py36-proj36
        - os: linux
          python: 3.4
          env: TOXENV=docs
        - os: linux
          python: 3.4
          env: TOXENV=py34-projdocs
        - os: linux
          python: 3.4
          env: TOXENV=py34-projpackaging
        - os: linux
          python: 3.4
          env: TOXENV=py34-projpy3pep8
        - os: linux
          python: 2.7
          env: TOXENV=py27-projpep8
        - os: linux
          python: 3.4
          env:
            - TOXENV=testdeploy
           # GitHub secured token, you need to update it to your own if you want to use it
            - secure: "TvwFrRVjQzxnvMjV5Spo/WAfWOIjOR4j91dBqRaykyG2WLkAS95iOwkNaa0OAcqDQf6uFJ2so54qpz8yPCZ+540hu3AspN2aeSS9IBmhia8CZ592BHm+plT2FPQZMC4PzXtG3eW1VnL+3Skvzwe4v6Qzffai8YdEWDnMYOrq8QkDeJnP2YqhatyrBih3FIhXWsNxk//5FHm7OEtQAAFhm4cjf2+vlhCE79kO3ynK/SXJuNXUk6+aKlnvus4Ya6kvMLihq+pE6+1pP/zn/YBU6u2qtR8/xg8oLP3FwrzAgczInlAeC8aRZVhknTtdmJQJcPyteSwAtrdeLST/uvHyYdBC1EVEntx08mDpUJqsEn7usGPsx+4GCJQ6VoBppvE9MutAitfDQV0xEQrb3ESM2mFJ1rX6vNVd6GSp5cX7Ko8rMneD4o8/PNUwRnmL0hu14GiVvd1up3pFT2a1Q0y19TIMRPbHx6Qdhl3Qa13Owa2p4tzGJzmntOD1dtdYahSXoV5Gc+uWLgCz9LnCLgvW2l8cyegz8kM7bLjrUdB3sj2b5QQZSeKWIrm5X7yk6ny2I8IwhIT0YSi7DJVOwENyaxAudrijzQZ3rxJJy2CfUPX8w7vrvZwLSisvQhqKHR3maVWx/q8CJ08uvI0ydGgjMo8TS4dZc9aHtAcwgFVGfTQ="
            # PyPI pass for test user
            - secure: "VHWp58N6lfUUFii2tPDRtcRq4YDnRndaLL5UH3WQem5BeQiaG4IVUBygF6vnT0nKMJQyQPtqmTaw2HdsSlhfEf+Z1WtWSHSYkvA5P7Z2CNZJP9PVsxGYlhmpxQEGSpJ7No2T5y/v0zqOK42Nz/1X11JLmLfbFLlvfyL7mv99HfJ4dhWKGo2IfGtm8J54mqdlxqDdfWyRMNaPAfTe/qb57dDLhsVfGsXQn2FyjpooOHGbCvXVYdBBOAnLfBn76rOowUr1dJekgzHiiQiAdNDZkQiPq6u5/h23yIKSFBM6uKb93XMzCE7r870xxXpY02pI/FXQw8gXW2/MoeJK0ptejahs+ae58qGUIi3jLJhn20ZiGNzFMKB9FoNFarjwjhXKyxhnKOdoRiRxIW2p9lgccELv/WGEhKzjUTiCORAvi37pNyb88IuiHmlUiCWmwIrpALN9FCKTfBzUgRBEw7VSrBIQI82aFBtQDtWcQRdqDBtIGakLDhap+oUU4p8fcgd4g4Y8wGkVr0XuLgYtDReDyAWAIp5Bqr1xYHd/bZnSwUKKQ+ICqWAExiDnHaNRpGnsjd26+UG18kU6HZ9/dxWADLq3J+5EvAUUBCPrZNsBKX0EtDo21oPI0JgNRfNkbjXLpvvaiNwOG/NswnfqnWQtcuycWqj9CSpBuSkhUIfUmxQ="
        - os: linux
          python: 3.4
          env: TOXENV=py34-projcov
        - os: osx
          language: generic
          env: TOXENV=py35-proj35
        - os: osx
          language: generic
          env: TOXENV=py34-proj34
        - os: osx
          language: generic
          env: TOXENV=py33-proj33
        - os: osx
          language: generic
          env: TOXENV=py27-proj27
    allow_failures:
        - env: TOXENV=py34-projcov

# check versions of tools, might be useful for debugging
before_install:
  - uname -a        # kernel version
  - python --version
  - virtualenv --version
  - pip --version

# upgrade virtualenv and tox
install:
  - if [[ $TRAVIS_OS_NAME == "linux" ]]; then bash ./.travis/install_linux.sh ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then bash ./.travis/install_osx.sh ; fi

# run tox tests
script:
  - if [[ $TRAVIS_OS_NAME == "linux" ]]; then tox ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then bash ./.travis/run_osx.sh ; fi
