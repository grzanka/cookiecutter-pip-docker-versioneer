language: python

# travis-ci runs by default on ancient Ubuntu 12.04 (precise), with support until XXX
# following options will give us Ubuntu 14.04 (trusty)
sudo: required
dist: trusty


# for testing we'll use tox
# test matrix will include three types of python interpreter:
#   - on travis level: "python: XX"
#   - inside template virtualenv generated by tox: "pyXX" in TOXENV
#   - testing template includes generating a project
#        this project will use virtualenv generated by ita own tox: "projXX" in TOXENV
# other elements like "docs" will be used to test correctness of template documentation
matrix:
    include:
        - os: linux
          python: 2.7
          env: TOXENV=py27-proj27
        - os: linux
          python: 3.3
          env: TOXENV=py33-proj33
        - os: linux
          python: 3.4
          env: TOXENV=py34-proj34
        - os: linux
          python: 3.5
          env: TOXENV=py35-proj35
        - os: linux
          python: 3.5-dev
          env: TOXENV=py35-proj35
        # travis nightly points to python 3.6 now
        - os: linux
          python: nightly
          env: TOXENV=py36-proj36
        - os: linux
          python: 3.4
          env: TOXENV=docs
        - os: linux
          python: 3.4
          env: TOXENV=py34-projdocs
        - os: linux
          python: 3.4
          env: TOXENV=py34-projpackaging
        - os: linux
          python: 3.4
          env: TOXENV=py34-projpy3pep8
        - os: linux
          python: 2.7
          env: TOXENV=py27-projpep8
        - os: linux
          python: 3.4
          env:
            - TOXENV=testdeploy
           # GitHub secured token, you need to update it to your own if you want to use it
            - secure: "TvwFrRVjQzxnvMjV5Spo/WAfWOIjOR4j91dBqRaykyG2WLkAS95iOwkNaa0OAcqDQf6uFJ2so54qpz8yPCZ+540hu3AspN2aeSS9IBmhia8CZ592BHm+plT2FPQZMC4PzXtG3eW1VnL+3Skvzwe4v6Qzffai8YdEWDnMYOrq8QkDeJnP2YqhatyrBih3FIhXWsNxk//5FHm7OEtQAAFhm4cjf2+vlhCE79kO3ynK/SXJuNXUk6+aKlnvus4Ya6kvMLihq+pE6+1pP/zn/YBU6u2qtR8/xg8oLP3FwrzAgczInlAeC8aRZVhknTtdmJQJcPyteSwAtrdeLST/uvHyYdBC1EVEntx08mDpUJqsEn7usGPsx+4GCJQ6VoBppvE9MutAitfDQV0xEQrb3ESM2mFJ1rX6vNVd6GSp5cX7Ko8rMneD4o8/PNUwRnmL0hu14GiVvd1up3pFT2a1Q0y19TIMRPbHx6Qdhl3Qa13Owa2p4tzGJzmntOD1dtdYahSXoV5Gc+uWLgCz9LnCLgvW2l8cyegz8kM7bLjrUdB3sj2b5QQZSeKWIrm5X7yk6ny2I8IwhIT0YSi7DJVOwENyaxAudrijzQZ3rxJJy2CfUPX8w7vrvZwLSisvQhqKHR3maVWx/q8CJ08uvI0ydGgjMo8TS4dZc9aHtAcwgFVGfTQ="
            # PyPI pass for test user (PYPIPASS variable)
            - secure: "QFZCmVVfyLqFNF4fMQo15xQZTFsx5OOFmnSiQTFlSHzYUxdNNBDInufP+1ZeDaICz60/+xxg9eoPhtFOCuf+BNM+RcPSWNwJJ32KLBTqf8HsXIbHnpXD37eu6d9GSLYd2EhZ8Bd095BMzI35KiEHoX8oWR8ksPgwLct4nPJFNToPQWPJyF2OabmYnWTe7D87nJcMptTDZhoOxSBocKxOeRJ9kPdQd4VHuzjXk7t5YUOdJjqZTosi01oVid3zRPsdvOrHVhdTkQuS0qocJeMu9+DPzLd6tlmh29o/BGvbV5QFYYKgNsA3eGKKjtJv6qJ19TzcaK3EXVAsHAGe7CDdwrEa//Q0dYAMU2WyD+19CiyZmgIqMSgeUD8P59dQhtsQIGrerGfxmgsg1GhjAgtcNBlhG/anjUj1/nIHHj/h/rSQAx9yXO1FrGhk2PIg6rSVZjFBYjMnGaNYEcJm3Xxdv3F7JfvCSkSgY+Nv/7oYGXyPTiob/LrUk52+7Tt16RL2FqjM3e0Ad465pq8t4j0IhVTGzbp0e42KvXuvkEOTSwYwdLsryb64JEzztPcjyWh5WLk0MDhHErowGebIIGJviTbN63j/qTRkfNHFSKLTVysUi/8gQp8azsjYNxf0WTbL61lZtgYL1hZa7o3tEWYS+ep8pqGfCgznE9q2G1lwjOU="
        - os: linux
          python: 3.4
          env: TOXENV=py34-projcov
        - os: osx
          language: generic
          env: TOXENV=py35-proj35
        - os: osx
          language: generic
          env: TOXENV=py34-proj34
        - os: osx
          language: generic
          env: TOXENV=py33-proj33
        - os: osx
          language: generic
          env: TOXENV=py27-proj27
    allow_failures:
        - env: TOXENV=py34-projcov

# check versions of tools, might be useful for debugging
before_install:
  - uname -a        # kernel version
  - python --version
  - virtualenv --version
  - pip --version

# upgrade virtualenv and tox
install:
  - if [[ $TRAVIS_OS_NAME == "linux" ]]; then bash ./.travis/install_linux.sh ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then bash ./.travis/install_osx.sh ; fi

# run tox tests
script:
  - if [[ $TRAVIS_OS_NAME == "linux" ]]; then travis_wait 60 tox ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then travis_wait bash ./.travis/run_osx.sh ; fi
